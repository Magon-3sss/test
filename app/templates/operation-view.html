{% extends 'components/base.html' %}
{% load static %}

    {% block styles %}
	<style>
		.leaflet-popup-content {
		  width: 500px;
		}
		#map {
			width: 100%;
			height: 50vh;
			box-shadow: 0 0 10px rgba(0,0,0,0.5);
		  }
	  </style>

    {% endblock %}

        {% block content %}

							<!-- PAGE-HEADER -->
							<div class="page-header">
								<div>
									<h1 class="page-title">Détails d'Opération Agricole</h1>
								</div>
								<div class="ms-auto pageheader-btn">
									<ol class="breadcrumb">
										<li class="breadcrumb-item"><a href="operations-utilisateur">Opérations Agricoles</a></li>
										<li class="breadcrumb-item active" aria-current="page">Opération Détails</li>
									</ol>
								</div>
							</div>
							<!-- PAGE-HEADER END -->

							<!--ROW OPENED-->
							<div class="row">
								<div class="col-md-12">
									<div class="btn-list text-end mb-3">
										<a href="javascript:void(0)" class="btn btn-primary active text-white me-2">Détail Opération Agricole
											<svg fill="#000000" width="24" height="24" viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title></title> <g> <path d="M18,24H78a6,6,0,0,0,0-12H18a6,6,0,0,0,0,12Z"></path> <path d="M78,42H18a6,6,0,0,0,0,12H78a6,6,0,0,0,0-12Z"></path> <path d="M78,72H18a6,6,0,0,0,0,12H78a6,6,0,0,0,0-12Z"></path> </g> </g></svg>
										</a>
										<a href="{% url 'operation-edit' operation.id %}" class="btn btn-outline-primary me-2">Modifier Opération Agricole
											<svg fill="#000000" width="24" height="24" viewBox="0 0 32 32" data-name="Layer 1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><title></title><path d="M14.13,12.48H7.4a.94.94,0,1,0,0,1.87h6.73a.94.94,0,0,0,0-1.87Z"></path><path d="M11.6,16.69H7.4a.93.93,0,1,0,0,1.86h4.2a.93.93,0,1,0,0-1.86Z"></path><path d="M28.48,6.86a.91.91,0,0,0-.28-.66L24.28,2.27a.94.94,0,0,0-1.32,0l-2.3,2.3H6.14A2.63,2.63,0,0,0,3.52,7.19V27.38A2.62,2.62,0,0,0,6.14,30h14.3a2.61,2.61,0,0,0,2.61-2.62V12.67L28.2,7.52A.94.94,0,0,0,28.48,6.86Zm-8,21.27H6.14a.75.75,0,0,1-.75-.75V7.19a.76.76,0,0,1,.75-.75H18.79L16.24,9a.92.92,0,0,0-.21.89v3.69a.92.92,0,0,0,.93.93h3.86a.94.94,0,0,0,.37-.07V27.38A.75.75,0,0,1,20.44,28.13Zm0-15.48H17.89V10l5.73-5.73,2.6,2.61Z"></path></g></svg>
										</a>
										<a href="{% url 'ajouter-operation-agricole' %}" class="btn btn-outline-primary me-2">Ajouter Opération Agricole
											<svg fill="#000000" height="24px" width="24px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M511.346,363.667l-4.839-10.268c-2.104-4.465-8.117-5.312-11.368-1.587l-36.612,41.922V336.73 c0-8.935-7.242-16.177-16.177-16.177h-86.698c-8.935,0-16.178,7.243-16.178,16.177v21.392L327,350.664 c-4.565-2.729-10.377,0.567-10.377,5.885v13.326c0,2.199,1.055,4.265,2.836,5.555l20.015,14.491v104.961 c0,8.936,7.243,16.178,16.178,16.178h86.698c8.935,0,16.177-7.242,16.177-16.178V458.27l52.508-88.17 C512.202,368.14,512.318,365.73,511.346,363.667z"></path> </g> </g> <g> <g> <path d="M270.171,184.274H167.935l0.009,303.622c0,12.793,10.37,23.162,23.162,23.162s23.162-10.369,23.162-23.162V302.761h10.001 v185.135c0,12.793,10.37,23.162,23.162,23.162s23.162-10.369,23.162-23.162C270.591,427.983,270.171,210.809,270.171,184.274z M235.809,253.627h-33.511c-6.299,0-11.407-5.108-11.407-11.407v-32.279c0-2.019,1.637-3.656,3.656-3.656h49.012 c2.019,0,3.656,1.637,3.656,3.656v32.279h0C247.217,248.519,242.11,253.627,235.809,253.627z"></path> </g> </g> <g> <g> <path d="M166.919,117.787c-0.022,0-0.043,0.001-0.065,0.001c-21.524,0.034-31.85,12.719-41.147,32.45l-10.449,19.688 c-9.382-22.467-7.974-18.786-17.139-40.732h19.519c5.855-9.302,13.313-17.601,23.629-22.816H87.988 c-5.148-7.025-14.592-9.906-22.987-6.404c-3.363,1.404-6.1,3.663-8.107,6.404H11.407C5.107,106.38,0,111.488,0,117.787 c0,6.299,5.107,11.408,11.407,11.408h44.878L95.124,222.2c6.258,14.983,27.127,16.014,34.818,1.691 c9.323-16.944,28.188-50.228,35.246-62.663c0.329-0.58,1.007-0.865,1.652-0.695c0.645,0.17,1.095,0.753,1.095,1.42v5.211h15.185 c0-11.721,0-38.175,0-49.376H166.919z"></path> </g> </g> <g> <g> <path d="M200.232,117.787c0,11.252,0,37.703,0,49.376h37.645c0-24.469,0-22.963,0-49.376 C229.101,117.787,220.148,117.787,200.232,117.787z"></path> </g> </g> <g> <g> <path d="M316.866,163.236c-0.125-25.039-20.623-45.449-45.677-45.449h-16.201c0,11.252,0,37.703,0,49.376h15.185v-3.771 c0-2.231,1.806-4.041,4.037-4.045c2.231-0.005,4.045,1.799,4.053,4.032c-0.221,91.544-0.225,60.375,0,145.545 c0.028,10.642,8.664,19.251,19.3,19.25c0.017,0,0.035,0,0.053,0c10.659-0.028,19.279-8.693,19.25-19.353 c-0.224-85.109-0.219-53.866,0.001-145.442C316.866,163.331,316.866,163.284,316.866,163.236z"></path> </g> </g> <g> <g> <path d="M256.815,31.211c-3.847-17.317-19.287-30.27-37.762-30.27c-18.475,0-33.915,12.953-37.762,30.268 c-22.594,3.448-37.808,9.89-37.808,17.272c0,7.139,14.217,13.397,35.576,16.921c0.199,22.025,18.159,39.634,39.994,39.634 c21.845,0,39.794-17.619,39.994-39.634c21.359-3.524,35.576-9.782,35.576-16.919C294.623,41.099,279.409,34.658,256.815,31.211z"></path> </g> </g> <g> <g> <path d="M401.259,106.38h-15.682v-7.693c0-2.679-2.17-4.849-4.848-4.849h-25.097c-2.678,0-4.848,2.17-4.848,4.849v7.693h-53.518 c5.818,2.668,11.252,6.225,16.088,10.62c4.01,3.642,7.484,7.75,10.393,12.195h26.085c-1.769,16.219-6,32.111-12.593,47.109 c-1.405,3.198,0.941,6.8,4.438,6.8h53.008c3.493,0,5.846-3.596,4.438-6.8c-6.593-14.999-10.824-30.89-12.593-47.109h14.729 c2.049,0,3.711-1.662,3.711-3.711V110.09C404.971,108.041,403.309,106.38,401.259,106.38z"></path> </g> </g> </g></svg>
										</a>
									</div>
									<div class="card overflow-hidden">
										<div class="card-body">
											<div class="row">
												<div class="col-xl col-md-12">
													<h5 class="my-2 card-title"> Type d'Opération & projet :
														{% comment %} {% if operation.typeoperation and operation.project_id %}
															{{ operation.typeoperation }} - {{ operation.project.project_name }}
														{% else %}
															Informations non disponibles
														{% endif %} {% endcomment %}
														{{ operation.typeoperation }} - {{ operation.project.project_name }}
													</h5>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="col-md-12">
									<div class="tab-content">
										<div class="tab-pane active" id="tab_1">
											<!-- ROW -->
											<div class="row">
												<div class="col-xl-9 col-lg-12">
													<div class="card">
														<div class="card-body">
															<div class="row prjct-details">
																<div class="col-xl-6 col-lg-12">
																	<div class="text-center border py-5 br-5 details">
																		<div>
																			<span class="m-0 text-muted"><i class="fe fe-calendar"></i>Date et Heure début d'opération :</span>
																		</div>
																		<h5 class="mt-3 text-teritary">{{ operation.date_debut}}</h5>
																	</div>
																</div>
																<div class="col-xl-6 col-lg-12">
																	<div class="text-center border py-5 br-5 details">
																		<div>
																			<span class="m-0 text-muted"><i class="fe fe-calendar"></i>Date et Heure fin d'opération :</span>
																		</div>
																		<h5 class="mt-3 text-danger">{{ operation.date_fin}}</h5>
																	</div>
																</div>
															</div>
														</div>
													</div>
													<div class="card">
														<div class="card-header border-bottom d-block">
															<div class="row align-items-center">
																<div class="col">
																	<h4 class="mb-1">Description</h4>
																	{% comment %} <div class="d-sm-flex d-block">
																		<div class="text-muted pe-2 project-date">11 Jan 21</div>
																		<div class="text-muted ms-3 project-status">In Progress</div>
																	</div> {% endcomment %}
																</div>
																{% comment %} <div class="col-auto">
																	<div class="d-flex align-items-center">
																		<i class="fa fa-star active stars-main ms-4" id="star"></i>
																		<div class="ms-3">
																			<a href="#" class="text-muted" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fe fe-more-vertical"></i></a>
																			<div class="dropdown-menu dropdown-menu-start">
																				<a class="dropdown-item" href="#"><i class="fe fe-edit me-2"></i> Edit</a>
																				<a class="dropdown-item" href="#"><i class="fe fe-share me-2"></i> Share</a>
																				<a class="dropdown-item" href="#"><i class="fe fe-download me-2"></i> Clone</a>
																				<a class="dropdown-item" href="#"><i class="fe fe-info me-2"></i> Report Issue</a>
																				<a class="dropdown-item" href="#"><i class="fe fe-trash me-2"></i> Delete</a>
																			</div>
																		</div>
																	</div>
																</div> {% endcomment %}
															</div>
														</div>
														<div class="card-body">
															{% comment %} <h5 class="mb-2">Opération Détails:</h5> {% endcomment %}
															<p class="line-height-5 m-0 text-muted">{{ operation.description}}</p>
															{% comment %} <ul class="mt-2">
																<li class="text-muted">
																	<svg xmlns="http://www.w3.org/2000/svg" class="w-inner-icn list-indicator" enable-background="new 0 0 24 24" viewBox="0 0 24 24"><path d="M14.8534546,11.6465454l-4.5-4.5c-0.1937256-0.1871948-0.5009155-0.1871948-0.6947021,0C9.460144,7.3383789,9.4546509,7.6549072,9.6464844,7.8535156L13.7930298,12l-4.1465454,4.1464844c-0.09375,0.09375-0.1464233,0.2208862-0.1464233,0.3534546C9.5,16.776062,9.723877,16.999939,10,17c0.1326294,0.0001221,0.2598267-0.0525513,0.3534546-0.1464844l4.5-4.5c0.000061-0.000061,0.0001221-0.000061,0.0001831-0.0001221C15.0487671,12.1581421,15.0487061,11.8416748,14.8534546,11.6465454z"/></svg>
																	Ea eos nonumy diam duo elitr. Takimata vero sit eirmod sit. Sea diam vero ipsum.
																</li>
																<li class="text-muted mt-1">
																	<svg xmlns="http://www.w3.org/2000/svg" class="w-inner-icn list-indicator" enable-background="new 0 0 24 24" viewBox="0 0 24 24"><path d="M14.8534546,11.6465454l-4.5-4.5c-0.1937256-0.1871948-0.5009155-0.1871948-0.6947021,0C9.460144,7.3383789,9.4546509,7.6549072,9.6464844,7.8535156L13.7930298,12l-4.1465454,4.1464844c-0.09375,0.09375-0.1464233,0.2208862-0.1464233,0.3534546C9.5,16.776062,9.723877,16.999939,10,17c0.1326294,0.0001221,0.2598267-0.0525513,0.3534546-0.1464844l4.5-4.5c0.000061-0.000061,0.0001221-0.000061,0.0001831-0.0001221C15.0487671,12.1581421,15.0487061,11.8416748,14.8534546,11.6465454z"/></svg>
																	Accusam ipsum labore dolor amet ea, accusam dolore dolor dolore.
																</li>
																<li class="text-muted mt-1">
																	<svg xmlns="http://www.w3.org/2000/svg" class="w-inner-icn list-indicator" enable-background="new 0 0 24 24" viewBox="0 0 24 24"><path d="M14.8534546,11.6465454l-4.5-4.5c-0.1937256-0.1871948-0.5009155-0.1871948-0.6947021,0C9.460144,7.3383789,9.4546509,7.6549072,9.6464844,7.8535156L13.7930298,12l-4.1465454,4.1464844c-0.09375,0.09375-0.1464233,0.2208862-0.1464233,0.3534546C9.5,16.776062,9.723877,16.999939,10,17c0.1326294,0.0001221,0.2598267-0.0525513,0.3534546-0.1464844l4.5-4.5c0.000061-0.000061,0.0001221-0.000061,0.0001831-0.0001221C15.0487671,12.1581421,15.0487061,11.8416748,14.8534546,11.6465454z"/></svg>
																	Nonumy gubergren gubergren lorem dolore nonumy lorem kasd, labore sit eirmod sed.
																</li>
																<li class="text-muted mt-1">
																	<svg xmlns="http://www.w3.org/2000/svg" class="w-inner-icn list-indicator" enable-background="new 0 0 24 24" viewBox="0 0 24 24"><path d="M14.8534546,11.6465454l-4.5-4.5c-0.1937256-0.1871948-0.5009155-0.1871948-0.6947021,0C9.460144,7.3383789,9.4546509,7.6549072,9.6464844,7.8535156L13.7930298,12l-4.1465454,4.1464844c-0.09375,0.09375-0.1464233,0.2208862-0.1464233,0.3534546C9.5,16.776062,9.723877,16.999939,10,17c0.1326294,0.0001221,0.2598267-0.0525513,0.3534546-0.1464844l4.5-4.5c0.000061-0.000061,0.0001221-0.000061,0.0001831-0.0001221C15.0487671,12.1581421,15.0487061,11.8416748,14.8534546,11.6465454z"/></svg>
																	Ipsum elitr no sed takimata dolore.
																</li>
															</ul> {% endcomment %}
														</div>
													</div>
												</div>
												<div class="col-xl-3 col-lg-12">
													<div class="card">
														<div class="card-header border-bottom">
															<h3 class="card-title">Fournitures agricoles</h3>
														</div>
														<div class="card-body">
															<ul class="task-list">
																<li>
																	<i class="task-icon bg-primary"></i>
																	<h4>Graines & Pousses :</h4>
																	<h6>- {{ operation.type_graines_pousses}}</h6>
																	<p class="text-muted fs-12">{{ operation.quantite_graine_utilisee}}Kg</p>
																</li>
																<li>
																	<i class="task-icon bg-secondary"></i>
																	<h4>Fertilisants  :</h4>
																	<h6>- {{ operation.type_engrais}}</h6>
																	<p class="text-muted fs-12">{{ operation.quantite_engrais_utilisee}}Kg</p>
																</li>
																<li>
																	<i class="task-icon bg-teritary"></i>
																	<h4>Traitements  :</h4>
																	<h6>- {{ operation.type_traitement}}</h6>
																	{% comment %} <h6><a href="#" class="fw-semibold text-dark">Emilie Benett</a> Found A New Bug.</h6> {% endcomment %}
																	<p class="text-muted fs-12">{{ operation.quantite_traitement_utilisee}}Kg</p>
																</li>
																{% comment %} <li>
																	<i class="task-icon bg-custom-yellow"></i>
																	<h6>New Member Added To The Project.</h6>
																	<p class="text-muted fs-12">05 Mar 2020</p>
																</li>
																<li>
																	<i class="task-icon bg-orange"></i>
																	<h6><a href="#" class="fw-semibold text-dark">Task-1</a> Completed Successfully.</h6>
																	<p class="text-muted fs-12">15 Mar 2020</p>
																</li>
																<li>
																	<i class="task-icon bg-primary"></i>
																	<h6>New Task Added To The Project.</h6>
																	<p class="text-muted fs-12">02 Apr 2020</p>
																</li> {% endcomment %}
															</ul>
														</div>
													</div>
												</div>
											</div><!--ROW CLOSED-->
										</div>
									</div>
								</div>
							</div>
							<!--ROW CLOSED-->

							<!--ROW OPENED-->
							<div class="row">
								<div class="col-md-12">
									<div class="tab-content">
										<div class="tab-pane active" id="tab_1">
											<!-- ROW -->
											<div class="row">
												<div class="col-xl-9 col-lg-12">
													<div class="card">
														<div class="card-header border-bottom d-block">
															<div class="row align-items-center">
																<div class="col">
																	<h4 class="mb-1">Main d'œuvre</h4>
																</div>
															</div>
														</div>

														<div class="card-body">
															<div class="table-responsive">
																<table class="table border text-nowrap text-md-nowrap table-striped">
																	<thead>
																		<tr>
																			<th>ID</th>
																			<th>Nom & Type</th>
																			<th>Date et heure de début</th>
																			<th>Date et heure de fin</th>
																			<th>Total des heures travaillées</th>
																		</tr>
																	</thead>
																	<tbody>
																		{% for main_doeuvre in main_doeuvres %}
																		<tr>
																			<td>{{ forloop.counter }}</td>
																			<td>{{ main_doeuvre.type_rh.nom }} {{ main_doeuvre.type_rh.prenom }} ({{ main_doeuvre.type_rh.type }})</td>
																			<td>{{ main_doeuvre.time }}</td>
																			<td>{{ main_doeuvre.timefin }}</td>
																			<td>{{ main_doeuvre.total_heures_travaillees }} H</td>
																		</tr>
																		{% endfor %}
																	</tbody>
																</table>
															</div>
														</div>

														{% comment %} <div class="card-body">
															{% for main_doeuvre in main_doeuvres %}
															<table class="table row table-borderless">
																<tbody class="col-lg-8 col-xl-4 p-0">
																	<tr>
																		<td><strong>{{ forloop.counter }}. Nom & Type :</strong> {{ main_doeuvre.type_rh.nom }} {{ main_doeuvre.type_rh.prenom }} ({{ main_doeuvre.type_rh.type }})</td>
																	</tr>
																</tbody>
																<tbody class="col-lg-8 col-xl-4 p-0 border-top-0">
																	<tr>
																		<td><strong>Date et heure de début :</strong> {{ main_doeuvre.time }}</td>
																	</tr>
																</tbody>
																<tbody class="col-lg-8 col-xl-4 p-0 border-top-1">
																	<tr>
																		<td><strong>Date et heure de fin :</strong> {{ main_doeuvre.timefin }}</td>
																	</tr>
																</tbody>
															</table>
															{% endfor %}
														</div> {% endcomment %}
														
													</div>
													<div class="card">
														<div class="card-header border-bottom d-block">
															<div class="row align-items-center">
																<div class="col">
																	<h4 class="mb-1">Machines et carburants</h4>
																</div>
															</div>
														</div>

														<div class="card-body">
															<div class="table-responsive">
																<table class="table border text-nowrap text-md-nowrap table-striped">
																	<thead>
																		<tr>
																			<th>ID</th>
																			<th>Type machine</th>
																			<th>Carburant</th>
																			<th>Quantité carburant</th>
																			<th>Date et Heure de début</th>
																			<th>Date et Heure de fin</th>
																			<th>Total des heures</th>
																		</tr>
																	</thead>
																	<tbody>
																		{% for machine_carburant in machine_carburants %}
																		<tr>
																			<td>{{ forloop.counter }}</td>
																			<td>{{ machine_carburant.type_machine_engins.type }} ({{ machine_carburant.type_machine_engins.matricule }})</td>
																			<td>{{ machine_carburant.carburant }}</td>
																			<td>{{ machine_carburant.quantite_carburant }} L</td>
																			<td>{{ machine_carburant.duree_utilisation_programme }}</td>
																			<td>{{ machine_carburant.heure_de_fin }}</td>
																			<td>{{ machine_carburant.total_heures_utilisation }}</td>
																		</tr>
																		{% endfor %}
																	</tbody>
																</table>
															</div>
														</div>

														{% comment %} <div class="card-body">
															{% for machine_carburant in machine_carburants %}
															<table class="table row table-borderless">
																<tbody class="col-lg-8 col-xl-4 p-0">
																	<tr>
																		<td><strong>{{ forloop.counter }}. Type machine :</strong> {{ machine_carburant.type_machine_engins.type }} ({{ machine_carburant.type_machine_engins.matricule }})</td>
																	</tr>
																	<tr>
																		<td><strong>Date et Heure de début :</strong> {{ machine_carburant.duree_utilisation_programme }}</td>
																	</tr>
																</tbody>
																<tbody class="col-lg-8 col-xl-4 p-0 border-top-0">
																	<tr>
																		<td><strong>Carburant :</strong> {{ machine_carburant.carburant }}</td>
																	</tr>
																	<tr>
																		<td><strong>Date et Heure de fin :</strong> {{ machine_carburant.heure_de_fin }}</td>
																	</tr>
																</tbody>
																<tbody class="col-lg-8 col-xl-4 p-0 border-top-1">
																	<tr>
																		<td><strong>Quantité carburant :</strong> {{ machine_carburant.quantite_carburant }} L</td>
																	</tr>
																</tbody>
															</table>
															{% endfor %}
														</div> {% endcomment %}
													</div>
												</div>

												<div class="col-xl-3 col-lg-12">
													<div class="card">
														<div class="card-header border-bottom">
															<h3 class="card-title">Outils Agricoles</h3>
														</div>
														<div class="card-body">
															<ul class="task-list">
																<li>
																	<i class="task-icon bg-custom-yellow"></i>
																	<h4>Outils :</h4>
																	{% for outil in outils %}
																	<h6> - {{ outil.name }}</h6>
																	{% endfor %}
																</li>
															</ul>
														</div>

														<div class="card-header border-bottom">
															<h3 class="card-title">Pièce de Rechange</h3>
														</div>
														<div class="card-body">
															<ul class="task-list">
																<li>
																	<i class="task-icon bg-orange"></i>
																	<h4>Pièces :</h4>
																	{% for piece in pieces %}
																	<h6> - {{ piece.type_pieces }}</h6>
																	<p class="text-muted fs-12">{{ piece.nombre_de_pieces }} pièces</p>
																	{% endfor %}
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div><!--ROW CLOSED-->

											<!-- ROW OPENED-->
											<div class="row">
												<div class="col-md-12">
													<div class="card">
														<div class="card-header border-bottom">
															<h3 class="card-title">Emplacement d'Opération Agricole</h3>
														</div>
														<div class="card-body pb-0">

															<div id="map">
																<!-- Map coordinate  -->
																<div class="leaflet-control map-coordinate">
																	<div class="coordinate"></div>
																</div>
															</div>
																<!-- leaflet js  -->
																<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
																<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
																<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
																<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
																<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
																<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
																<script src="{% static './lib/leaflet.markercluster.js' %}"></script>
																<script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
																<script src="{% static './data/test.js' %}"></script>
																<script src="{% static './dist/main.js' %}"></script>
																<script src="{% static './dist/web-GIS.js' %}"></script>
									
																<!-- leaflet draw plugin  -->
																<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.css"/>
																<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.js"></script>
																
																<script>
																	// Initialize the map
																	var mapcenter = [51.505, -0.09];  // Default map center if no points are provided
																	var map = L.map('map', {zoomControl: false}).setView(mapcenter, 11);
																
																	// Base layers
																	var googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
																		maxZoom: 20,
																		subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
																	}).addTo(map);
																
																	var googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
																		maxZoom: 20,
																		subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
																	});
																
																	L.control.layers({
																		"Satellite": googleSat,
																		"Street": googleStreets
																	}).addTo(map);
																
																	// Group layers for markers and project points
																	var projectLayer = L.layerGroup().addTo(map);
																	var markerLayer = L.layerGroup().addTo(map);
																
																	// Add project points to the map
																	var projectPoints = {{ project_points|safe }};
																	var allPoints = [];
																	
																	projectPoints.forEach(function(shape) {
																		if (shape.type === 'circle') {
																			var circle = L.circle([shape.center.latitude, shape.center.longitude], {radius: shape.radius}).addTo(projectLayer)
																				.bindPopup("Circle with radius: " + shape.radius);
																			allPoints.push([shape.center.latitude, shape.center.longitude]);
																		} else if (shape.type === 'polygon') {
																			var latlngs = shape.coordinates.map(function(coord) {
																				return [coord.latitude, coord.longitude];
																			});
																			L.polygon(latlngs).addTo(projectLayer).bindPopup("Polygon");
																			allPoints = allPoints.concat(latlngs);  // Add all polygon points to the array
																		} else if (shape.type === 'rectangle') {
																			var latlngs = shape.coordinates.map(function(coord) {
																				return [coord.latitude, coord.longitude];
																			});
																			L.rectangle(latlngs).addTo(projectLayer).bindPopup("Rectangle");
																			allPoints = allPoints.concat(latlngs);  // Add all rectangle points to the array
																		} else if (shape.type === 'point') {
																			var pointMarker = L.marker([shape.latitude, shape.longitude]).addTo(projectLayer)
																				.bindPopup("Point: (" + shape.latitude + ", " + shape.longitude + ")");
																			allPoints.push([shape.latitude, shape.longitude]);
																		}
																	});
																
																	// Add operation markers to the map
																	var markers = {{ markers|safe }};
																	markers.forEach(function(marker) {
																		var markerPoint = L.marker([marker.latitude, marker.longitude]).addTo(markerLayer)
																			.bindPopup("Marker: (" + marker.latitude + ", " + marker.longitude + ")");
																		allPoints.push([marker.latitude, marker.longitude]);  // Add each marker to the array
																	});
																
																	// If there are points, adjust the map to fit all points
																	if (allPoints.length > 0) {
																		var bounds = L.latLngBounds(allPoints);
																		map.fitBounds(bounds);
																	} else {
																		// If no points, set default center and zoom level
																		map.setView(mapcenter, 11);
																	}
																</script>
																
															{% comment %} <script>
																// Map initialization 
																var mapcenter = [51.505, -0.09];
																var map = L.map('map', {zoomControl: false}).setView(mapcenter, 11);
															
																//google satellite
																googleSat = L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
																	maxZoom: 20,
																	subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
																});googleSat.addTo(map)
															
																// Zoom Control
																var zoomControl = L.control.zoom({
																	position: "topleft"
																});
																zoomControl.addTo(map);  
															
																// google street 
																googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {
																	maxZoom: 20,
																	subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
																});
																//googleStreets.addTo(map);
															
															var baselayer = {
																"Satellite": googleSat,
																"Street": googleStreets,
																
																"Street": googleStreets
															}
															
															L.control.layers(baselayer, /*overlayers*/).addTo(map)
															
															
															// sideBySide 
															L.control.sideBySide(ls, mf).addTo(map);

															
															</script> {% endcomment %}
														</div> 
													</div>
												</div>
											</div><!--ROW CLOSED-->
										</div>
									</div>
								</div>
							</div>
							<!--ROW CLOSED-->
		{% endblock %}

    {% block scripts %}

		<!-- INTERNAL SELECT2 JS -->
		<script src="{% static 'assets/plugins/select2/select2.full.min.js'%}"></script>

		<!-- FILE UPLOAD JS -->
        <script src="{% static 'assets/plugins/fileuploads/js/fileupload.js'%}"></script>
        <script src="{% static 'assets/plugins/fileuploads/js/file-upload.js'%}"></script>

		<!-- bootstrap-datepicker js -->
		<script src="{% static 'assets/plugins/bootstrap-datepicker/js/datepicker.js'%}"></script>

		<!-- INTERNAL Data tables js-->
		<script src="{% static 'assets/plugins/datatable/js/jquery.dataTables.min.js'%}"></script>
		<script src="{% static 'assets/plugins/datatable/js/dataTables.bootstrap5.js'%}"></script>
		<script src="{% static 'assets/plugins/datatable/dataTables.responsive.min.js'%}"></script>

		<!-- PROJECT-DETAILS JS-->
		<script src="{% static 'assets/js/operation-view.js'%}"></script>

        <!-- COLOR THEME JS -->
        <script src="{% static 'assets/js/themeColors.js'%}"></script>

    {% endblock %}